{
    "collab_server" : "",
    "contents" : "abNode=function(depth,max,wFrom,wTo,index=1){\n  mid=wFrom+(wTo-wFrom)/2\n  out=NULL\n  if (depth==0)\n    out=list(index=NA,nextIndex=index,\n             max=max,value=sample(-25:25,1),\n             alpha=NA,beta=NA,depth=depth,width=mid)\n  else {\n    nextIndex=index+1\n    A=abNode(depth-1,!max,wFrom,mid,nextIndex)\n    nextIndex=A$nextIndex\n    B=abNode(depth-1,!max,mid,wTo,nextIndex)\n    nextIndex=B$nextIndex\n    out=list(\n      index=index,\n      nextIndex=nextIndex,\n      A=A,\n      B=B,\n      max=max,\n      value=NA,\n      alpha=NA,\n      beta=NA,\n      depth=depth,\n      width=mid\n      )\n  }\n  class(out)=\"abn\"\n  return(out)\n}\n\nplot.abn=function(obj,from=NULL) {\n  if (!is.null(from))\n    segments(obj$width,obj$depth,from$width,from$depth)\n  if (!is.null(obj$A))\n    plot(obj$A,obj)\n  if (!is.null(obj$B))\n    plot(obj$B,obj)\n  if (is.na(obj$value)) {\n    points(obj$width,obj$depth,col=ifelse(obj$max,\"red\",\"light blue\"),\n           pch=ifelse(obj$max,15,16),cex=3)\n    text(obj$width,obj$depth,obj$index)\n  }\n  else\n    text(obj$width,obj$depth-.3,obj$value,col=ifelse(obj$max,\"red\",\"blue\"))\n}\nalphaBetaPruning=function(depth=4,firstMax=T) {\n  out=list(\n    root=abNode(depth,firstMax,0,2^depth),\n    depth=depth,\n    firstMax=firstMax,\n    width=2^depth\n  )\n  class(out)=\"abp\"\n  return(out)\n}\n\nsolveABP=function(obj,comments) {\n  solveABN(obj$root,comments=comments)\n}\nannounceABN=function(obj,alpha,beta,pass=FALSE) {\n  if (pass)\n    cat(\"Alpha-beta values passed on to node \",obj$index,\".\\n\",sep=\"\")\n  else\n    cat(\"Alpha-beta values updated for node \",obj$index,\".\\n\",sep=\"\")\n  cat(\"Node: \",obj$index,\"  alpha=\",alpha,\", beta=\",beta,sep=\"\")\n  readline(\"\")\n}\npruneABP=function(to,from,comments,pruned=NULL){\n  col=ifelse(is.null(pruned),\"orange\",\"red3\")\n  size=.4\n  midWidth=(from$width+to$width)/2\n  midDepth=(from$depth+to$depth)/2\n  segments(midWidth-size,midDepth-size,midWidth+size,midDepth+size,col=col,lwd=3)\n  segments(midWidth-size,midDepth+size,midWidth+size,midDepth-size,col=col,lwd=3)\n  if (!is.null(pruned)) {\n    midWidth=(pruned$width+to$width)/2\n    midDepth=(pruned$depth+to$depth)/2\n    segments(midWidth-size,midDepth-size,midWidth+size,midDepth+size,col=col,lwd=3)\n  }\n  if (comments){\n    readline(\"\")\n  }\n}\nsolveABN=function(obj,alpha=-Inf,beta=Inf,from=NULL,comments=T) {\n  if (!is.na(obj$value)) {\n    if (comments){\n      cat(\"The algorithm has reached the assigned value (\",obj$value,\n          \") so it is returned.\",sep=\"\")\n      readline(\"\")\n    }\n    return(obj$value)\n  }\n  if (comments) {\n    announceABN(obj,alpha,beta,T)\n  }\n  if (obj$max) {\n    isA=T\n    for (child in list(obj$A,obj$B)) {\n      v=solveABN(child,alpha,beta,obj,comments)\n      if (v>alpha) {\n        alpha=v\n        if (comments) {\n          announceABN(obj,alpha,beta)\n        }\n      }\n      else {\n        if (comments){\n          cat(\"Alpha-beta values are not updated for node \",obj$index,\".\",sep=\"\")\n          readline(\"\")\n        }\n      }\n      if (alpha>=beta) {\n        if (isA){\n          if (comments){\n            cat(\"Alpha-beta interval collapses - a prune is possible.\\n\")\n          }\n          pruneABP(obj,from,comments,obj$B)\n        }\n        else {\n          if (comments){\n            cat(\"Alpha-beta interval collapses. But since this occurred on the last child of node \",obj$index,\n              \", it does not help reduce the work done by the algorithm. This normally just means the branch has been ruled out as being involving the optimal path of play. We mark it in orange.\",sep=\"\")\n          }\n          pruneABP(obj,from,comments)\n        }\n        return (alpha)\n      }\n      isA=!isA\n    }\n    if (comments){\n      cat(\"Node \",obj$index,\" is a max node, so the alpha value (\",alpha,\n        \") is returned.\",sep=\"\")\n      readline(\"\")\n    }\n    return (alpha)\n  }\n  else {\n    isA=T\n    for (child in list(obj$A,obj$B)) {\n      v=solveABN(child,alpha,beta,obj,comments)\n      if (v<beta){\n        beta=v\n        if (comments) {\n          announceABN(obj,alpha,beta)\n        }\n      }\n      else {\n        if (comments){\n          cat(\"Alpha-beta values are not updated for node \",obj$index,\".\",sep=\"\")\n          readline(\"\")\n        }\n      }\n      if (alpha>=beta) {\n        if (isA){\n          if (comments){\n            cat(\"Alpha-beta interval collapses - a prune is possible.\\n\")\n          }\n          pruneABP(obj,from,comments,obj$B)\n        }\n        else {\n          if (comments){\n            cat(\"Alpha-beta interval collapses. But since this occurred on the last child of node \",obj$index,\n              \", it does not help reduce the work done by the algorithm. This normally just means the branch has been ruled out as being involving the optimal path of play. We mark it in orange.\",sep=\"\")\n          }\n          pruneABP(obj,from,comments)\n        }\n        return (beta)\n      }\n      isA=!isA\n    }\n    if (comments){\n      cat(\"Node \",obj$index,\" is a min node, so the beta value (\",beta,\n        \") is returned.\",sep=\"\")\n      readline(\"\")\n    }\n    return (beta)\n  }\n}\nplot.abp=function(obj) {\n  plot.new()\n  plot.window(xlim=c(-0.5,obj$width+.5),ylim=c(-0.5,obj$depth+.5))\n  plot(obj$root)\n  title(\"Game tree for alpha-beta pruning.\")\n  legend(0,obj$depth+.5,c(\"MAX\",\"MIN\"),col=c(\"red\",\"light blue\"),pch=c(15,16),cex=1)\n}\nmakeQuestionAlphaBeta=function(seed=NA,answer=T,latex=F,comments=T,imageFilename=NULL) {\n  if (!is.na(seed))\n    set.seed(seed)\n  model=alphaBetaPruning()\n\n  if (!is.null(imageFilename))\n    jpeg(imageFilename)\n  plot(model)\n  if (!is.null(imageFilename))\n    dev.off()\n\n  if (latex) {\n    cat(\"\\\\clearpage\\n\")\n    cat(\"\\\\section{Alpha-Beta Pruning}\\n\\n\")\n    cat(\n      \"Examine the game tree included in this exam. Note that the values in the nodes are node indices, not mini-max values. Perform alpha-beta pruning on this game tree. \",\n      \"You should show all working, where this means all alpha-beta values. \",\n      \"You can write these values on the diagram, or alternatively on a separate sheet of paper. \",\n      \"In both cases, provide a way of identifying the sequence of updates to alpha-beta values associated with nodes (we suggest you just cross out old values and write new values sequentially downwards). \",\n      \"If you write on a separate sheet of paper, use the node indices in the diagram as a way of identifying which node particular alpha-beta values are associated with. \",\n      \"Show where pruning occurs, by indicating which branches will not be evaluated. \",\n      \"Finally, provide the result (value at end state) of the game assuming optimal play. (3 marks)\\n\"\n    )\n  }\n  else {\n    cat(\n      \"Examine the game tree in the plot window. Note that the values in the nodes are node indices, not mini-max values. Perform alpha-beta pruning on this game tree. \",\n      \"You should show all working, where this means all alpha-beta values. \",\n      \"Show where pruning occurs, by indicating which branches will not be evaluated. \",\n      \"Finally, provide the result (value at end state) of the game assuming optimal play.\\n\",sep=\"\")\n  }\n  if (answer) {\n    cat(\n      \"Note that in the exam, you will be expected to record all alpha-beta values and how they change, normally on the plot. \",\n      \"Since this is difficult to do in a small plot, we output these values and their changes in text in the console. \",\n      \"You will also need to mark branches that are pruned. We use crosses to mark the branch where the alpha-beta interval collapses, and single lines to mark the branches that are pruned as a result. \",\n      \"Where no branches are pruned, the cross is in orange. You will not be required to mark the orange crosses in the exam. \",\n      \"They are included here for pedogogical reasons.\\n\")\n    res=solveABP(model,comments)\n    title(sub=paste(\"The result of this game will be\",res))\n  }\n}\ntestSolveAlphaBeta=function(seed=NA) {\n  if (!is.na(seed))\n    set.seed(seed)\n  model=alphaBetaPruning()\n  plot(model)\n  cat(\"Note that in the exam, you will be expected to record all alpha-beta values and how they change, normally on the plot. Since this is difficult to do in a small plot, we output these values and their changes in text in the console. You will also need to mark branches that are pruned. We use crosses to mark the branch where the alpha-beta interval collapses, and single lines to mark the branches that are pruned as a result. Where no branches are pruned, the cross is in orange. You will not be required to mark the orange crosses in the exam. They are included here for pedogogical reasons.\")\n  readline()\n  res=solveABP(model)\n  title(paste(\"The result of this game will be\",res))\n}\n",
    "created" : 1508102311969.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3451799771",
    "id" : "F2E4188B",
    "lastKnownWriteTime" : 1512860563,
    "last_content_update" : 1512860563479,
    "path" : "C:/Users/Acer/Desktop/Dokument/AI/2017/AIExam/R/alphabeta.R",
    "project_path" : "R/alphabeta.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}